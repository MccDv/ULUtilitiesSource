VERSION 5.00
Begin VB.Form lblResult 
   Caption         =   "Rate Calculator"
   ClientHeight    =   5010
   ClientLeft      =   60
   ClientTop       =   360
   ClientWidth     =   4020
   Icon            =   "Rater.frx":0000
   LinkTopic       =   "Form1"
   ScaleHeight     =   5010
   ScaleWidth      =   4020
   StartUpPosition =   3  'Windows Default
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   63
      Left            =   6420
      TabIndex        =   67
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   62
      Left            =   6420
      TabIndex        =   66
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   61
      Left            =   6420
      TabIndex        =   65
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   60
      Left            =   6420
      TabIndex        =   64
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   59
      Left            =   6420
      TabIndex        =   63
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   58
      Left            =   6420
      TabIndex        =   62
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   57
      Left            =   6420
      TabIndex        =   61
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   56
      Left            =   6420
      TabIndex        =   60
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   55
      Left            =   5520
      TabIndex        =   59
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   54
      Left            =   5520
      TabIndex        =   58
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   53
      Left            =   5520
      TabIndex        =   57
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   52
      Left            =   5520
      TabIndex        =   56
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   51
      Left            =   5520
      TabIndex        =   55
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   50
      Left            =   5520
      TabIndex        =   54
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   49
      Left            =   5520
      TabIndex        =   53
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   48
      Left            =   5520
      TabIndex        =   52
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   47
      Left            =   4620
      TabIndex        =   51
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   46
      Left            =   4620
      TabIndex        =   50
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   45
      Left            =   4620
      TabIndex        =   49
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   44
      Left            =   4620
      TabIndex        =   48
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   43
      Left            =   4620
      TabIndex        =   47
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   42
      Left            =   4620
      TabIndex        =   46
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   41
      Left            =   4620
      TabIndex        =   45
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   40
      Left            =   4620
      TabIndex        =   44
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   39
      Left            =   3720
      TabIndex        =   43
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   38
      Left            =   3720
      TabIndex        =   42
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   37
      Left            =   3720
      TabIndex        =   41
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   36
      Left            =   3720
      TabIndex        =   40
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   35
      Left            =   3720
      TabIndex        =   39
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   34
      Left            =   3720
      TabIndex        =   38
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   33
      Left            =   3720
      TabIndex        =   37
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   32
      Left            =   3720
      TabIndex        =   36
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtNumChans 
      Height          =   315
      Left            =   1500
      TabIndex        =   35
      Text            =   "2"
      ToolTipText     =   "Number of channels"
      Top             =   120
      Width           =   975
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   31
      Left            =   2820
      TabIndex        =   34
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   30
      Left            =   2820
      TabIndex        =   33
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   29
      Left            =   2820
      TabIndex        =   32
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   28
      Left            =   2820
      TabIndex        =   31
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   27
      Left            =   2820
      TabIndex        =   30
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   26
      Left            =   2820
      TabIndex        =   29
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   25
      Left            =   2820
      TabIndex        =   28
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   345
      Index           =   24
      Left            =   2820
      TabIndex        =   27
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   23
      Left            =   1920
      TabIndex        =   26
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   22
      Left            =   1920
      TabIndex        =   25
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   21
      Left            =   1920
      TabIndex        =   24
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   20
      Left            =   1920
      TabIndex        =   23
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   19
      Left            =   1920
      TabIndex        =   22
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   18
      Left            =   1920
      TabIndex        =   21
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   17
      Left            =   1920
      TabIndex        =   20
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   16
      Left            =   1920
      TabIndex        =   19
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   15
      Left            =   1020
      TabIndex        =   18
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   14
      Left            =   1020
      TabIndex        =   17
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   13
      Left            =   1020
      TabIndex        =   16
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   12
      Left            =   1020
      TabIndex        =   15
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   11
      Left            =   1020
      TabIndex        =   14
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   10
      Left            =   1020
      TabIndex        =   13
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   9
      Left            =   1020
      TabIndex        =   12
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   8
      Left            =   1020
      TabIndex        =   11
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   7
      Left            =   120
      TabIndex        =   10
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   3120
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   6
      Left            =   120
      TabIndex        =   9
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2760
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   5
      Left            =   120
      TabIndex        =   8
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2400
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   4
      Left            =   120
      TabIndex        =   7
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   2040
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   3
      Left            =   120
      TabIndex        =   6
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1680
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   2
      Left            =   120
      TabIndex        =   5
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   1320
      Visible         =   0   'False
      Width           =   795
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   1
      Left            =   120
      TabIndex        =   4
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   960
      Width           =   795
   End
   Begin VB.ComboBox cmbADRate 
      Height          =   315
      Left            =   120
      TabIndex        =   3
      Text            =   "Combo1"
      Top             =   120
      Width           =   1215
   End
   Begin VB.CommandButton cmdCalc 
      Caption         =   "Go"
      Default         =   -1  'True
      Height          =   375
      Left            =   120
      TabIndex        =   1
      Top             =   3600
      Width           =   915
   End
   Begin VB.TextBox txtChanRate 
      Height          =   315
      Index           =   0
      Left            =   120
      TabIndex        =   0
      Text            =   "3750"
      ToolTipText     =   "Double click to set selected rate"
      Top             =   600
      Width           =   795
   End
   Begin VB.Label lblActualRate 
      Alignment       =   1  'Right Justify
      Caption         =   "Actual aggregate rate:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   60
      TabIndex        =   70
      Top             =   4500
      Width           =   1995
   End
   Begin VB.Label lblSetRate 
      Alignment       =   1  'Right Justify
      Caption         =   "Max set rate:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   480
      TabIndex        =   69
      Top             =   4080
      Width           =   1575
   End
   Begin VB.Label lblPacerRate 
      ForeColor       =   &H00FF0000&
      Height          =   255
      Left            =   2160
      TabIndex        =   68
      Top             =   4500
      Width           =   1695
   End
   Begin VB.Label lblResult 
      ForeColor       =   &H00FF0000&
      Height          =   255
      Left            =   2160
      TabIndex        =   2
      Top             =   4080
      Width           =   1695
   End
End
Attribute VB_Name = "lblResult"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Dim mnNumChans As Integer

Private Sub cmdCalc_Click()

   Me.lblPacerRate.Caption = ""
   Me.lblResult.Caption = ""
   If Not mnNumChans = Val(Me.txtNumChans) Then UpdateChans

   For i% = 1 To mnNumChans
      ADRate# = Val(Me.txtChanRate(i% - 1).Text)
      ThisChan# = 1 / ADRate# + 0.00064
      Cum# = Cum# + ThisChan#
   Next
   If Not Cum# = 0 Then Result# = 1 / Cum#
   Me.lblResult.Caption = Result#
   
   Divisor% = Int(50000 / Result#)
   PacerRate# = (50000 / Divisor%) * mnNumChans
   If PacerRate# > Result# Then
      Divisor% = Divisor% + 1
      PacerRate# = (50000 / Divisor%) * mnNumChans
   End If
   Me.lblPacerRate.Caption = PacerRate#
   
End Sub

Private Sub Form_Load()

   cmbADRate.AddItem "3750"
   cmbADRate.AddItem "2000"
   cmbADRate.AddItem "1000"
   cmbADRate.AddItem "500"
   cmbADRate.AddItem "100"
   cmbADRate.AddItem "60"
   cmbADRate.AddItem "50"
   cmbADRate.AddItem "25"
   cmbADRate.AddItem "10"
   cmbADRate.AddItem "5"
   cmbADRate.AddItem "2.5"
   cmbADRate.ListIndex = 0

End Sub

Private Sub txtChanRate_DblClick(Index As Integer)

   Me.txtChanRate(Index).Text = Me.cmbADRate.Text
   
End Sub

Private Sub txtNumChans_KeyDown(KeyCode As Integer, Shift As Integer)

   If KeyCode = 13 Then UpdateChans

End Sub

Sub UpdateChans()

   mnNumChans = Val(Me.txtNumChans.Text)
   If mnNumChans > Me.txtChanRate.Count Then
      mnNumChans = Me.txtChanRate.Count
      Me.txtNumChans.Text = Format(mnNumChans, "0")
   End If
   Select Case mnNumChans
      Case Is < 33
         Me.Width = 4260
      Case Is < 41
         Me.Width = 4845
      Case Is < 49
         Me.Width = 5685
      Case Is < 57
         Me.Width = 6645
      Case Else
         Me.Width = 7530
   End Select
   For Chan% = 0 To Me.txtChanRate.Count - 1
      Me.txtChanRate(Chan%).Visible = (Chan% < mnNumChans)
   Next

End Sub
